<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scroll Animation Replica (Enhanced)</title>
    <style>
        :root {
            --bg-dark: #121212;
            --bg-light: #F1F0E8;
            --text-light: #EAEAEA;
            --text-dark: #121212;
            --accent-green: #39FF14;
            --purple: #8A2BE2;
            --green: #2E8B57;
            --orange: #FF4500;
            --yellow: #FFD700;
            --blue: #4169E1;
        }

        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-dark);
            color: var(--text-light);
            overflow-x: hidden;
            /* Added transition for smooth color change */
            transition: background-color 1.2s cubic-bezier(0.25, 1, 0.5, 1);
        }

        .scroller {
            height: 500vh;
        }

        header {
            width: 100%;
            padding: 1.5rem 5%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: fixed;
            top: 0;
            z-index: 100;
        }

        .logo {
            font-weight: 900;
            font-size: 1.5rem;
            color: var(--text-light);
            border: 2px solid var(--text-light);
            padding: 0.2rem 0.5rem;
            transition: color 1.2s ease, border-color 1.2s ease;
        }

        nav {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        nav a.nav-link {
            color: var(--text-light);
            text-decoration: none;
            margin: 0 1rem;
            font-weight: 700;
            transition: color 1.2s ease;
        }

        .launch-button {
            background-color: var(--accent-green);
            color: var(--text-dark);
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 2rem;
            font-weight: 700;
            cursor: pointer;
        }

        .content-wrapper {
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: sticky;
            top: 0;
            overflow: hidden;
        }

        .initial-screen {
            text-align: center;
            position: absolute;
        }

        .initial-screen h1 {
            font-size: clamp(2.5rem, 8vw, 5rem);
            font-weight: 900;
            max-width: 15ch;
            line-height: 1.1;
        }

        .initial-screen p {
            font-size: 1.2rem;
            margin-top: 1rem;
            color: #aaa;
        }

        .initial-screen .download-button {
            margin-top: 2rem;
            background: var(--text-light);
            color: var(--text-dark);
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
        }

        .icons-container {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .icon {
            width: clamp(120px, 15vw, 180px);
            height: clamp(120px, 15vw, 180px);
            border-radius: 35px;
            display: flex;
            justify-content: center;
            align-items: center;
            position: absolute;
            /* Added box-shadow for depth */
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            will-change: transform, width, height; /* Performance optimization */
        }

        .icon svg {
             width: 60%;
             height: 60%;
             fill: var(--text-light);
        }

        .icon-music { background-color: var(--purple); }
        .icon-movie { background-color: var(--green); }
        .icon-game { background-color: var(--orange); }
        .icon-shop { background-color: var(--yellow); }
        .icon-fashion { background-color: var(--blue); }

        .final-screen {
            position: absolute;
            opacity: 0;
            visibility: hidden;
            width: 90%;
            max-width: 1000px;
            color: var(--text-dark);
            text-align: center;
        }

        .final-screen .fun-fact {
            font-size: 1rem;
            color: #555;
            margin-bottom: 2rem;
        }

        .final-screen .text-block {
            font-size: clamp(2rem, 7vw, 4rem);
            font-weight: 900;
            line-height: 1.3;
            text-align: left;
        }

        .text-line {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            /* Set initial state for animation */
            opacity: 0;
            transform: translateY(20px);
        }

        .inline-icon-placeholder {
            width: clamp(40px, 8vw, 70px);
            height: clamp(40px, 8vw, 70px);
            margin: 0 0.5rem;
            flex-shrink: 0;
            display: inline-flex;
        }

    </style>
</head>
<body>

    <header>
        <div class="logo">DATA</div>
        <nav>
            <a href="#" class="nav-link">About</a>
            <a href="#" class="nav-link">Features</a>
            <a href="#" class="nav-link">Contact</a>
            <button class="launch-button">Launch App</button>
        </nav>
    </header>

    <div class="scroller">
        <div class="content-wrapper">

            <div class="initial-screen">
                <h1>Your data runs the world</h1>
                <p>Start earning from it today.</p>
                <button class="download-button">Download Rewards Extension</button>
            </div>

            <div class="final-screen">
                <p class="fun-fact">Here's a fun fact: Today, you are the product</p>
                <div class="text-block">
                    <div class="text-line" data-icon-id="icon-music">Your favorite <span class="inline-icon-placeholder"></span> songs.</div>
                    <div class="text-line" data-icon-id="icon-movie">That <span class="inline-icon-placeholder"></span> must-see movie.</div>
                    <div class="text-line" data-icon-id="icon-game">Your top <span class="inline-icon-placeholder"></span> interests and</div>
                    <div class="text-line" data-icon-id="icon-shop icon-fashion">all your shopping <span class="inline-icon-placeholder"></span><span class="inline-icon-placeholder"></span> habits.</div>
                </div>
            </div>

            <div class="icons-container">
                <div class="icon icon-music" id="icon-music">
                    <svg viewBox="0 0 24 24"><path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55c-2.21 0-4 1.79-4 4s1.79 4 4 4s4-1.79 4-4V7h4V3h-6Z"/></svg>
                </div>
                <div class="icon icon-movie" id="icon-movie">
                    <svg viewBox="0 0 24 24"><path d="m18 4l2 4h-3l-2-4h-2l2 4h-3l-2-4H8l2 4H7L5 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4h-4Z"/></svg>
                </div>
                <div class="icon icon-game" id="icon-game">
                    <svg viewBox="0 0 24 24"><path d="M12 2a10 10 0 0 0-10 10a10 10 0 0 0 10 10a10 10 0 0 0 10-10A10 10 0 0 0 12 2M9.5 7A1.5 1.5 0 0 1 11 8.5A1.5 1.5 0 0 1 9.5 10A1.5 1.5 0 0 1 8 8.5A1.5 1.5 0 0 1 9.5 7m5 0A1.5 1.5 0 0 1 16 8.5A1.5 1.5 0 0 1 14.5 10A1.5 1.5 0 0 1 13 8.5A1.5 1.5 0 0 1 14.5 7M8 14v3h8v-3z"/></svg>
                </div>
                <div class="icon icon-shop" id="icon-shop">
                    <svg viewBox="0 0 24 24"><path d="M18 6h-2c0-2.21-1.79-4-4-4S8 3.79 8 6H6c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm-6-2c1.1 0 2 .9 2 2h-4c0-1.1.9-2 2-2zm6 16H6V8h2v2c0 .55.45 1 1 1s1-.45 1-1V8h4v2c0 .55.45 1 1 1s1-.45 1-1V8h2v12z"/></svg>
                </div>
                <div class="icon icon-fashion" id="icon-fashion">
                    <svg viewBox="0 0 24 24"><path d="M18.14 3.42c-.44-.23-.96-.18-1.34.13L15 5.29l-1.15-1.14a1.003 1.003 0 0 0-1.41 0l-.71.71c-.39.39-.39 1.02 0 1.41L13.41 8l-2.83 2.83c-.39.39-.39 1.02 0 1.41l.71.71c.39.39 1.02.39 1.41 0l2.83-2.83L17.29 10l1.74-1.74c.31-.32.41-.77.27-1.18l-1.16-3.66ZM12 11.26l-6 6V22h4.74l6-6L12 11.26Z"/></svg>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>

    <script>
        gsap.registerPlugin(ScrollTrigger);

        // --- SELECTORS ---
        const contentWrapper = document.querySelector(".content-wrapper");
        const icons = gsap.utils.toArray('.icon');

        // --- ANIMATION CONSTANTS ---
        const DURATION = 1.0;
        const STAGGER = 0.1;
        const EASE = "power2.inOut";

        // --- HELPER FUNCTION ---
        // Calculates final position for an icon relative to the viewport center.
        const getFinalPos = (placeholder) => {
            const placeholderBounds = placeholder.getBoundingClientRect();
            const contentWrapperBounds = contentWrapper.getBoundingClientRect();
            // Calculate position relative to the center of the content-wrapper
            const x = placeholderBounds.left - contentWrapperBounds.left - (contentWrapperBounds.width / 2) + (placeholderBounds.width / 2);
            const y = placeholderBounds.top - contentWrapperBounds.top - (contentWrapperBounds.height / 2) + (placeholderBounds.height / 2);
            return {
                x,
                y,
                width: placeholderBounds.width,
                height: placeholderBounds.height,
            };
        };

        // --- INITIAL STATE ---
        // Start icons spread out horizontally at the bottom of the screen
        gsap.set(icons, {
            top: "50%",
            left: "50%",
            xPercent: -50,
            yPercent: -50,
            y: "35vh",
            x: (i) => (i - (icons.length - 1) / 2) * 220,
        });

        // --- MASTER TIMELINE ---
        const masterTl = gsap.timeline({
            scrollTrigger: {
                trigger: ".scroller",
                start: "top top",
                end: "bottom bottom",
                scrub: 1,
                invalidateOnRefresh: true, // Recalculates on resize
            }
        });

        // 1. Initial Screen Fade Out
        masterTl.to('.initial-screen', {
            opacity: 0,
            y: -100,
            duration: DURATION / 2,
        }, "start");

        // 2. Cluster Icons and Change Theme
        masterTl.add("cluster", "-=0.2")
            .to(icons, {
                x: 0,
                y: 0,
                scale: 0.3,
                rotation: -15,
                duration: DURATION,
                stagger: STAGGER / 2,
                ease: EASE
            }, "cluster")
            .to('body', { backgroundColor: 'var(--bg-light)', duration: DURATION }, "cluster")
            .to('.logo, .nav-link', { color: 'var(--text-dark)', duration: DURATION }, "cluster")
            .to('.logo', { borderColor: 'var(--text-dark)', duration: DURATION }, "cluster");

        // 3. Reveal Final Screen Content
        masterTl.add("reveal", ">")
            .to('.final-screen', { opacity: 1, visibility: 'visible', duration: 0.1 }, "reveal")
            .from('.fun-fact', { opacity: 0, y: 20, duration: DURATION / 2 }, "reveal");

        // 4. Move Icons to Final Placeholders and Reveal Text Lines
        // This loop makes the code scalable and maintainable.
        masterTl.add("moveAndReveal", ">-0.2");
        icons.forEach((icon, i) => {
            const line = document.querySelector(`[data-icon-id*="${icon.id}"]`);
            const placeholders = line.querySelectorAll('.inline-icon-placeholder');

            // Find the correct placeholder for the current icon
            const placeholder = Array.from(placeholders).find((p, index) => {
                const ids = line.dataset.iconId.split(' ');
                return ids[index] === icon.id;
            });

            if (placeholder) {
                // Animate the icon
                masterTl.to(icon, {
                    ...getFinalPos(placeholder),
                    borderRadius: 15,
                    scale: 1,
                    rotation: 0,
                    duration: DURATION,
                    ease: EASE
                }, `moveAndReveal+=${i * STAGGER}`);

                // Animate the corresponding text line to reveal it
                // '<' inserts this tween at the start of the previous one (the icon move)
                // '+=0.4' adds a slight delay for better rhythm
                masterTl.to(line, {
                    opacity: 1,
                    y: 0,
                    duration: DURATION / 1.5,
                    ease: "power1.out"
                }, "<+=0.4");
            }
        });

        // 5. Final flourish - a small pop to signal completion
        masterTl.to(icons, {
            scale: (i) => {
                const iconEl = icons[i];
                const line = document.querySelector(`[data-icon-id*="${iconEl.id}"]`);
                return line ? 1.05 : 0.3; // only pop the icons that moved
            },
            duration: DURATION / 2,
            yoyo: true,
            repeat: 1,
            stagger: STAGGER,
            ease: "power2.inOut"
        }, ">-0.5");


        // --- RESIZE HANDLING ---
        // ScrollTrigger handles this automatically with invalidateOnRefresh: true,
        // but explicit refresh can be good practice for complex layouts.
        window.addEventListener('resize', () => {
            ScrollTrigger.refresh();
        });

    </script>
</body>
</html>
